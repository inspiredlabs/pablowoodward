<!-- Scripts -->
<style>.b-lazy {-webkit-transition: opacity 500ms ease-in-out;-moz-transition: opacity 500ms ease-in-out;-o-transition: opacity 500ms ease-in-out;transition: opacity 500ms ease-in-out;max-width: 100%;opacity:0;}.b-loaded {opacity:1;}</style>
<!-- http://dinbror.dk/blog/blazy/ -->
<script>
	(function(q,m){"function"===typeof define&&define.amd?define(m):"object"===typeof exports?module.exports=m():q.Blazy=m()})(this,function(){function q(b){var c=b._util;c.elements=E(b.options);c.count=c.elements.length;c.destroyed&&(c.destroyed=!1,b.options.container&&l(b.options.container,function(a){n(a,"scroll",c.validateT)}),n(window,"resize",c.saveViewportOffsetT),n(window,"resize",c.validateT),n(window,"scroll",c.validateT));m(b)}function m(b){for(var c=b._util,a=0;a<c.count;a++){var d=c.elements[a],e;a:{var g=d;e=b.options;var p=g.getBoundingClientRect();if(e.container&&y&&(g=g.closest(e.containerClass))){g=g.getBoundingClientRect();e=r(g,f)?r(p,{top:g.top-e.offset,right:g.right+e.offset,bottom:g.bottom+e.offset,left:g.left-e.offset}):!1;break a}e=r(p,f)}if(e||t(d,b.options.successClass))b.load(d),c.elements.splice(a,1),c.count--,a--}0===c.count&&b.destroy()}function r(b,c){return b.right>=c.left&&b.bottom>=c.top&&b.left<=c.right&&b.top<=c.bottom}function z(b,c,a){if(!t(b,a.successClass)&&(c||a.loadInvisible||0<b.offsetWidth&&0<b.offsetHeight))if(c=b.getAttribute(u)||b.getAttribute(a.src)){c=c.split(a.separator);var d=c[A&&1<c.length?1:0],e=b.getAttribute(a.srcset),g="img"===b.nodeName.toLowerCase(),p=(c=b.parentNode)&&"picture"===c.nodeName.toLowerCase();if(g||void 0===b.src){var h=new Image,w=function(){a.error&&a.error(b,"invalid");v(b,a.errorClass);k(h,"error",w);k(h,"load",f)},f=function(){g?p||B(b,d,e):b.style.backgroundImage='url("'+d+'")';x(b,a);k(h,"load",f);k(h,"error",w)};p&&(h=b,l(c.getElementsByTagName("source"),function(b){var c=a.srcset,e=b.getAttribute(c);e&&(b.setAttribute("srcset",e),b.removeAttribute(c))}));n(h,"error",w);n(h,"load",f);B(h,d,e)}else b.src=d,x(b,a)}else"video"===b.nodeName.toLowerCase()?(l(b.getElementsByTagName("source"),function(b){var c=a.src,e=b.getAttribute(c);e&&(b.setAttribute("src",e),b.removeAttribute(c))}),b.load(),x(b,a)):(a.error&&a.error(b,"missing"),v(b,a.errorClass))}function x(b,c){v(b,c.successClass);c.success&&c.success(b);b.removeAttribute(c.src);b.removeAttribute(c.srcset);l(c.breakpoints,function(a){b.removeAttribute(a.src)})}function B(b,c,a){a&&b.setAttribute("srcset",a);b.src=c}function t(b,c){return-1!==(" "+b.className+" ").indexOf(" "+c+" ")}function v(b,c){t(b,c)||(b.className+=" "+c)}function E(b){var c=[];b=b.root.querySelectorAll(b.selector);for(var a=b.length;a--;c.unshift(b[a]));return c}function C(b){f.bottom=(window.innerHeight||document.documentElement.clientHeight)+b;f.right=(window.innerWidth||document.documentElement.clientWidth)+b}function n(b,c,a){b.attachEvent?b.attachEvent&&b.attachEvent("on"+c,a):b.addEventListener(c,a,{capture:!1,passive:!0})}function k(b,c,a){b.detachEvent?b.detachEvent&&b.detachEvent("on"+c,a):b.removeEventListener(c,a,{capture:!1,passive:!0})}function l(b,c){if(b&&c)for(var a=b.length,d=0;d<a&&!1!==c(b[d],d);d++);}function D(b,c,a){var d=0;return function(){var e=+new Date;e-d<c||(d=e,b.apply(a,arguments))}}var u,f,A,y;return function(b){if(!document.querySelectorAll){var c=document.createStyleSheet();document.querySelectorAll=function(a,b,d,h,f){f=document.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(d=a.length;d--;){c.addRule(a[d],"k:v");for(h=f.length;h--;)f[h].currentStyle.k&&b.push(f[h]);c.removeRule(0)}return b}}var a=this,d=a._util={};d.elements=[];d.destroyed=!0;a.options=b||{};a.options.error=a.options.error||!1;a.options.offset=a.options.offset||100;a.options.root=a.options.root||document;a.options.success=a.options.success||!1;a.options.selector=a.options.selector||".b-lazy";a.options.separator=a.options.separator||"|";a.options.containerClass=a.options.container;a.options.container=a.options.containerClass?document.querySelectorAll(a.options.containerClass):!1;a.options.errorClass=a.options.errorClass||"b-error";a.options.breakpoints=a.options.breakpoints||!1;a.options.loadInvisible=a.options.loadInvisible||!1;a.options.successClass=a.options.successClass||"b-loaded";a.options.validateDelay=a.options.validateDelay||25;a.options.saveViewportOffsetDelay=a.options.saveViewportOffsetDelay||50;a.options.srcset=a.options.srcset||"data-srcset";a.options.src=u=a.options.src||"data-src";y=Element.prototype.closest;A=1<window.devicePixelRatio;f={};f.top=0-a.options.offset;f.left=0-a.options.offset;a.revalidate=function(){q(a)};a.load=function(a,b){var c=this.options;void 0===a.length?z(a,b,c):l(a,function(a){z(a,b,c)})};a.destroy=function(){var a=this._util;this.options.container&&l(this.options.container,function(b){k(b,"scroll",a.validateT)});k(window,"scroll",a.validateT);k(window,"resize",a.validateT);k(window,"resize",a.saveViewportOffsetT);a.count=0;a.elements.length=0;a.destroyed=!0};d.validateT=D(function(){m(a)},a.options.validateDelay,a);d.saveViewportOffsetT=D(function(){C(a.options.offset)},a.options.saveViewportOffsetDelay,a);C(a.options.offset);l(a.options.breakpoints,function(a){if(a.width>=window.screen.width)return u=a.src,!1});setTimeout(function(){q(a)})}});var bLazy=new Blazy({validateDelay:320,breakpoints:[{width:420,src:'data-src-small'}],success:function(element){setTimeout(function(){var parent=element.parentNode;parent.className=parent.className.replace(/\bloading\b/,'');},200);}});
</script>

<script src="{{ .Site.BaseURL }}js/flickity.pkgd.min.js"></script>
<script src="{{ .Site.BaseURL }}js/hash.min.js"></script>
<script>
document.ontouchmove = function(event) {
  var isTouchMoveAllowed = true,
    target = event.target;
  while (target !== null) {
    if (target.classList && target.classList.contains('disable-scrolling')) {
      isTouchMoveAllowed = false;
      break;
    }
    target = target.parentNode;
  }
  if (!isTouchMoveAllowed) {
    event.preventDefault();
  }
};

function removeIOSRubberEffect(element) {
  element.addEventListener("touchstart", function() {
    var top = element.scrollTop,
      totalScroll = element.scrollHeight,
      currentScroll = top + element.offsetHeight;
    if (top === 0) {
      element.scrollTop = 1;
    } else if (currentScroll === totalScroll) {
      element.scrollTop = top - 1;
    }
  });
}
removeIOSRubberEffect(document.querySelector(".scrollable"));
</script>
<!--script>document.ontouchmove=function(event){var isTouchMoveAllowed=true,target=event.target;while(target!==null){if(target.classList&&target.classList.contains('disable-scrolling')){isTouchMoveAllowed=false;break;}
target=target.parentNode;}if(!isTouchMoveAllowed){event.preventDefault();}};function removeIOSRubberEffect(element){element.addEventListener("touchstart",function(){var top=element.scrollTop,totalScroll=element.scrollHeight,currentScroll=top+element.offsetHeight;if(top===0){element.scrollTop=1;}else if(currentScroll===totalScroll){element.scrollTop=top-1;}});}
removeIOSRubberEffect(document.querySelector(".scrollable"));</script-->
<!-- Lazyload docs: https://flickity.metafizzy.co/options.html -->



<script>		

function initGroup() {
	var init = document.querySelector('.button-group--cells').getElementsByTagName('button')[0];
	init.classList.add('is-selected');		
};

function removeHash() { 
	history.pushState("", document.title, window.location.pathname + window.location.search);
}; // - from: https://stackoverflow.com/questions/1397329/how-to-remove-the-hash-from-window-location-url-with-javascript-without-page-r/5298684#5298684

var carousel = document.querySelector('.carousel');
var flkty = new Flickity( carousel, {
  prevNextButtons: false,
  dragThreshold:72,//66  
  wrapAround: true,
  selectedAttraction: 0.2,// codepen.io/desandro/pen/aOyMam
  friction: 1,
	//isInstant: true,		// https://codepen.io/desandro/pen/jzEOZq	  
  pageDots: false,			  
  //resize: false,		// see: https://flickity.metafizzy.co/options.html#resize
  hash: true,
  on: {

    ready: function() {
    
    	//Begin store
    	let uri = window.location.hash.substr(1);
    	let list = document.getElementsByTagName('button');

    	if (uri == '' ) {
    		//alert('empty');
    		initGroup();
    		return;
    	}//if

    	// MATCH or not?
    	for (var i=0; i<list.length; i++) {
    		let listItem = list[i].getAttribute('data-weight');  		    		
    		
    		if (uri !== listItem) {	  		    		
	    		//populated correctly, but not yet = move on
	    		//DEBUG alert('not:' + listItem); //DEBUG
	    		//populated wrong = sanitise
	    		
    		} else if (uri == listItem) {
	    		//Store
    			//DEBUG alert('this:' + listItem); //DEBUG
    			let init = document.querySelector('.button-group--cells').getElementsByTagName('button')[i];
    			init.classList.add('is-selected');
    		} else {
    			//DEBUG alert(uri);//DEBUG
    			// 2047-06112019
    			initGroup();
    			removeHash(); 
    		}//if

    		
    	}//for
    	//retinaBounce();    	    	
    }//ready
  }//on
  
});

// NEW:			
//			var utils = window.fizzyUIUtils;
//			var cellsButtonGroup = document.querySelector('.button-group--cells');
//			var cellsButtons = utils.makeArray( cellsButtonGroup.children );
//			
//			// update buttons on select
//			flkty.on( 'select', function() {
//			  var previousSelectedButton = cellsButtonGroup.querySelector('.is-selected');
//			  var selectedButton = cellsButtonGroup.children[ flkty.selectedIndex ];
//			  previousSelectedButton.classList.remove('is-selected');
//			  selectedButton.classList.add('is-selected');
//			  carousel.focus();
//			});
//			
//			// cell select
//			cellsButtonGroup.addEventListener( 'click', function( event ) {
//			  if ( !matchesSelector( event.target, '.button' ) ) {
//			    return;
//			  }
//			  var index = cellsButtons.indexOf( event.target );
//			  flkty.select( index );
//			});
			
// PREVIOUS:
var buttonGroup = document.querySelector('.button-group--cells');
var buttons = buttonGroup.querySelectorAll('.button');
buttons = fizzyUIUtils.makeArray(buttons);
flkty.on('select', function() {
    var previousSelectedButton = buttonGroup.querySelector('.is-selected');
    var selectedButton = buttonGroup.children[flkty.selectedIndex];
    previousSelectedButton.classList.remove('is-selected');
    selectedButton.classList.add('is-selected');
});
buttonGroup.addEventListener('click', function(event) {
  if (!matchesSelector(event.target, '.button')) {
    return;
  }
  var index = buttons.indexOf(event.target);
  // isInstant: true,
  flkty.select(index, false, true);
});
</script>
<script>
	(function(){
		var href=document.getElementsByTagName('a');
		for( var i=0; i<href.length; i++ ) {
			href[i].ondragstart=function() {
				return false;
			}
		}
	})();
</script>
<script>	
	
	// revalidate bLazy
	var bLazy = new Blazy({
		offset: 1800, // Loads 1800px before visible: http://dinbror.dk/blog/blazy/
	  success: function(){
	    updateCounter();
	  }
	});
	
	// debugInfo
	var imageLoaded = 0;
	var eleCountLoadedImages = document.getElementById('debugInfo');
	
	function updateCounter() {
	  imageLoaded++;
	  eleCountLoadedImages.innerHTML = imageLoaded;
	}
	
</script>
<script>

(function(){

	function retinaBounce() { 	
		let number = Math.floor((Math.random()*1000));
		setTimeout(function(){ bLazy.revalidate(); }, number);
		console.log('retinaBounce:' + number);
	};

	let section = document.querySelectorAll("section");
	
	section.forEach(function(elem) {
		elem.addEventListener("mouseover", retinaBounce);
		elem.addEventListener("touchstart", retinaBounce);
	});
	
	// https://stackoverflow.com/questions/40956717/how-to-addeventlistener-to-multiple-elements-in-a-single-line:
	// elementsArray.forEach(el => el.addEventListener('input', functionThatDoesStuff))
	
	
})();



(function(){
	
	//https://stackoverflow.com/questions/4917664/detect-viewport-orientation-if-orientation-is-portrait-display-alert-message-ad
	const debounce = (func, wait, immediate) => {
		var timeout;
		return () => {
			const context = this, args = arguments;
			const later = function() {
				timeout = null;
				if (!immediate) func.apply(context, args);
			};
			const callNow = immediate && !timeout;
			clearTimeout(timeout);
			timeout = setTimeout(later, wait);
			if (callNow) func.apply(context, args);
		};
	};
	
	
	function orient() {
		
    function layoutBounce() { 	
      let number = Math.floor((Math.random()*1000));
      setTimeout(function(){ flkty.resize(); }, number);
    };
    
    if (window.innerHeight > window.innerWidth) {
			//alert('portrait');
			layoutBounce()
		} else {
			//alert('landscape');
			layoutBounce()
		}//if	

	}//orient
	
	// Listen for orientation changes
//	window.addEventListener("orientationchange", function() {
//	  orient();
//	}, false);

	window.addEventListener('orientationchange', () => orient(), false);
	
	// Listen for resize changes
//	window.addEventListener("resize", function() {
//	  orient();
//	}, false);

	window.addEventListener('resize', debounce(() => orient(),
	200, false), false);
	
})();

</script>


<!--script>Element.prototype.remove=function(){this.parentElement.removeChild(this);}
NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var i=this.length-1;i>=0;i--){if(this[i]&&this[i].parentElement){this[i].parentElement.removeChild(this[i]);}}};(function(){var displayOnlineStatus=document.getElementById("online-status"),isOnline=function(){displayOnlineStatus.innerHTML=document.getElementById('iframeOnline').innerHTML;displayOnlineStatus.className="online";document.getElementsByClassName("offline").remove();},isOffline=function(){displayOnlineStatus.innerHTML=document.getElementById('iframeOffline').innerHTML;displayOnlineStatus.className="offline";document.getElementsByClassName("online").remove();};if(window.addEventListener){window.addEventListener("online",isOnline,false);window.addEventListener("offline",isOffline,false);}
else{document.body.ononline=isOnline;document.body.onoffline=isOffline;};})();window.addEventListener('load',function(){if(navigator.onLine){document.getElementById("online-status").innerHTML=document.getElementById('iframeOnline').innerHTML;document.getElementById("online-status").className="online";}else{document.getElementById("online-status").innerHTML=document.getElementById('iframeOffline').innerHTML;document.getElementById("online-status").className="offline";}});</script-->

<!--<script src="{{ .Site.BaseURL }}js/bg-lazyload.js"></script>-->
<script>

/*
var altCarousel = document.querySelector('.altCarousel');
var flickity = new Flickity( altCarousel, {
  bgLazyLoad: 1,
  prevNextButtons: false,
  dragThreshold:3,//66
  wrapAround: true,
  pageDots: false,			  
  autoPlay: 100
});



// external js: flickity.pkgd.js

var flkty = new Flickity('.altCarousel');
var isFlickity = true;

var toggleButton = document.querySelector('.button--toggle');
toggleButton.addEventListener( 'click', function() {
  if ( isFlickity ) {
    flkty.destroy();
  } else {
    flkty = new Flickity('.altCarousel');
  }
  isFlickity = !isFlickity;
});
*/

</script>
<!-- <style>
  /* https://codepen.io/pawelgrzybek/pen/YWqWXJ from: https://pawelgrzybek.com/the-intersection-observer-api-explained/ */
  p {
    -webkit-transform: scale(0.75) translateY(3.2rem);
          transform: scale(0.75) translateY(3.2rem);
  opacity: .3;
}
  
  @-webkit-keyframes loaded {
  0% {
    -webkit-transform: scale(0.75) translateY(3.2rem);
            transform: scale(0.75) translateY(3.2rem);
    opacity: .3;
  }
  100% {
    -webkit-transform: none;
            transform: none;
    opacity: 1;
  }
}

@keyframes loaded {
  0% {
    -webkit-transform: scale(0.75) translateY(3.2rem);
            transform: scale(0.75) translateY(3.2rem);
    opacity: .3;
  }
  100% {
    -webkit-transform: none;
            transform: none;
    opacity: 1;
  }
}
.loaded {
  animation-delay: 2s;
  -webkit-animation-delay: 2s; /* Chrome, Safari, Opera */
  -webkit-animation-name: loaded;
          animation-name: loaded;
  -webkit-animation-duration: 300ms;
          animation-duration: 300ms;
  -webkit-animation-fill-mode: both;
          animation-fill-mode: both;
}
</style>
<script>
  // the callback function that will be fired
  // when the element apears in the viewport
  // because it fires on initialization
  // we have to check for change.isIntersecting parameter
  function onEntry(entry) {
    entry.forEach((change) => {
      if (change.isIntersecting) {
        change.target.classList.add('loaded');
      }
    });
  }

  // list of options
  let options = {
    threshold: [0.5]
  };

  // instantiate a new Intersection Observer
  let observer = new IntersectionObserver(onEntry, options);

  // list of iframe
  let elements = document.querySelectorAll('p');

  // loop through all elements
  // pass each element to observe method
  // ES2015 for-of loop can traverse through DOM Elements
  for (let elm of elements) {
    observer.observe(elm);
  }
</script> -->
<script>

// the callback function that will be fired
  // when the element apears in the viewport
  // because it fires on initialization
  // we have to check for change.isIntersecting parameter
  function onEntry(entry) {
    entry.forEach((change) => {
      if (change.isIntersecting) {
        
        
        (function(){
          var iframe = document.getElementsByTagName('iframe');
          for (var i=0; i<iframe.length; i++) {
            if(iframe[i].getAttribute('data-src')) {
              iframe[i].setAttribute('src',iframe[i].getAttribute('data-src'));
              iframe[i].removeAttribute('data-src'); //use only if you need to remove
            }
          }
        })();


      }
    });
  }

  // list of options
  let options = {
    threshold: [0.5]
  };

  // instantiate a new Intersection Observer
  let observer = new IntersectionObserver(onEntry, options);

  // list of iframe
  let elements = document.querySelectorAll('iframe');

  // loop through all elements
  // pass each element to observe method
  // ES2015 for-of loop can traverse through DOM Elements
  for (let elm of elements) {
    observer.observe(elm);
  }




</script>